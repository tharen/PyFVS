version: 0.0.{build}

# init:
  # # Display remote desktop details
  # - ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

install:
    - set "PATH=C:\mingw-w64\x86_64-8.1.0-posix-seh-rt_v6-rev0\mingw64\bin;C:\Windows\System32;C:\Windows;%PATH%"
    - set CHERE_INVOKING=1
    
build_script:
    - cd bin
    - del "C:\Program Files\Git\usr\bin\sh.exe"
    - cmake -G"MinGW Makefiles" . -DFVS_VARIANTS=pn -DCMAKE_SYSTEM_NAME=Windows -DMAKE_JOBS=1
    - cmake --build . -j1
    
after_build:
    - cmake --build . --target make_zip

artifacts:
    - path: bin\open-fvs.zip
      name: open-fvs
      type: zip
    
# on_finish:
  # # Pause the build for remote desktop access
  # - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))